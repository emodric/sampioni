
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>

<title>Primjeri kodiranja</title>

<meta content="Microsoft FrontPage 5.0" name="GENERATOR">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	    <link rel="stylesheet" type="text/css" href="/css/sampioni.css">
	</head>
	<body>

<table height="50" cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td width="2%" class="header">&nbsp;</td>
    <td class="header"> <a href="/">
    <img border="0" src="/images/logo.gif" width="150" height="75"></a></td>
    <td width="50%" class="header" valign="bottom" align="right">

<p class="citat">Sve su firme šampionske, razlika je samo u kompenzaciji. <br>
&nbsp;</p>

    </td>

  </tr>
  <tr>
    <td width="2%" class="subheader">&nbsp;</td>
    <td class="subheader" height="20" colspan="2">


Site o šampionizmu i šampionskim firmama na hrvatskoj informatičkoj sceni.
    </td>
  </tr>
</table>
		<table cellspacing="0" cellpadding="1" width="100%" border="0">
			<tr>

    <td height="10"></td>
			</tr>
		</table>

<table cellspacing="0" cellpadding="1" width="100%" border="0">
  <tr>
    <td>
      <table cellspacing="0" cellpadding="0" width="20%" align="left" border="0">
        <tr>
          <td width="2%"></td>
          <td width="10%"></td>
          <td class="navigation">&nbsp; </td>
        </tr>
      </table>
      <table width="80%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="3%">&nbsp;</td>
          <td>
            |<nobr><a href="/" target="" style="{text-decoration: none;}">O&nbsp;šampionima&nbsp;i&nbsp;šampionizmu</a></nobr>&nbsp;|&nbsp;<nobr><a href="/sampionski_manifest.html" target="" style="{text-decoration: none;}">Šampionski&nbsp;manifest</a></nobr>&nbsp;|&nbsp;<nobr><a href="/legenda.html" target="" style="{text-decoration: none;}">Legenda&nbsp;o&nbsp;šampionima</a></nobr>&nbsp;|&nbsp;<nobr><a href="/vaseprice.html" target="" style="{text-decoration: none;}">Vaše&nbsp;priče</a></nobr>&nbsp;|&nbsp;<nobr><a href="/posaljitepricu.html" target="" style="{text-decoration: none;}">Pošaljite&nbsp;svoju&nbsp;priču</a></nobr>&nbsp;|&nbsp;<nobr><a href="/ogledi.html" target="" style="{text-decoration: none;}">Ogledi&nbsp;o&nbsp;šampionizmu</a></nobr>&nbsp;|&nbsp;<nobr><a href="/ankete/ankete.html" target="" style="{text-decoration: none;}">Ankete</a></nobr>&nbsp;|&nbsp;<nobr><a href="/biseri.html" target="" style="{text-decoration: none;}">Šampionski&nbsp;biseri</a></nobr>
          </td>
        </tr>
        <tr>
          <td width="3%" height="2"><img height="2" width="2" src="/images/1.gif"></td>
          <td height="2"></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td>
      <table cellspacing="0" cellpadding="0" width="20%" align="left" border="0">
        <tr>
          <td width="2%"></td>
          <td width="10%"></td>
          <td class="navigation">
            <nobr>Primjeri&nbsp;kodiranja</nobr><br><nobr><a href="/biseri/kod/primjeri_koda2.html" target="" style="{text-decoration: none;}">Još&nbsp;primjera&nbsp;koda</a></nobr><br><nobr><a href="/biseri/crtice/crtice.html" target="" style="{text-decoration: none;}">Crtice&nbsp;iz&nbsp;šampionskog&nbsp;života</a></nobr>
          </td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="1" width="*%" border="0">
        <tr>
          <td class="separator" width="3%">&nbsp;</td>
          <td class="ContentTitleHead" bgcolor="#CCCCCC" align="center">
          Šampionski biseri  </td>
        </tr>
        <tr>
          <td class="separator" width="3%">&nbsp;</td>
          <td>
            <a href="/biseri/kod/primjeri_koda2.html" target="" style="{text-decoration: none;}">Nastavak&nbsp;(Next)</a>
          </td>
        </tr>
        <tr>
          <td class="separator" width="3%">&nbsp;</td>
          <td class="ContentTitle">
          Primjeri kodiranja</td>
        </tr>
        <tr>
          <td colspan="2" height="10" class="separator">&nbsp;</td>
        </tr>
        <tr>
          <td class="separator" width="3%">&nbsp;</td>
          <td class="Content">
          <p class="ContentSubTitle">Sadržaj:</p>
          <p><a href="#Stinkyeva for-petljica">Stinkyeva for-petljica</a><br>
          <a href="#Maddogov Update podataka u bazi">Maddogov Update podataka u
          bazi</a><br>
          <a href="#Šampion nikad ne kaže NOT! (by Stinky)">Šampion nikad ne
          kaže NOT! (by Stinky)</a><br>
          <a href="#Točka, točka, točkica (by svi šampioni)">Točka, točka,
          točkica (by svi šampioni)</a><br>
          <a href="#Usporedba logičke varijable s True ili False (Stinky)">
          Usporedba logičke varijable s True ili False (Stinky)</a><br>
          <a href="#Zanimljivo izračunavanje broja elemenata polja (Nepoznati autor)">
          Zanimljivo izračunavanje broja elemenata polja (Nepoznati autor)</a><br>
          <a href="#Šampionski efikasno brisanje svih zapisa u tablici (by Pridruženi šampion)">
          Šampionski efikasno brisanje svih zapisa u tablici (by Pridruženi
          šampion)</a></p>
          <p class="ContentSubTitle">
          <a name="Stinkyeva for-petljica">Stinkyeva for-petljica</a><p>Priča o Stinkyevoj for-petljici već je
          ispričana u <a href="/legenda/stinky.html">poglavlju</a> o ovom programerskom gigantu ali nije zgorega
          malo ponoviti. Dakle, Stinky je dobio hitan zahtjev za izmjenom jednog
          modula u DAMP web aplikaciji. Inače je cijeli kod te web aplikacije
          pisao i održavao Bojan, ali je tada dotični bio u Dembeliji na drugom
          projektu. Budući da nitko drugi u firmi nije znao ASP, Stinky je bio
          jedini logičan izbor za taj task. <br>
          Nije potrebno ni reći da se Bojan po povratku iz Dembelije užasnuo kad
          je vidio kako je Stinky izmasakrirao njegov kod, ali naročito mu je
          upala u oko sljedeća konstrukcija:<table border="0" cellspacing="0" width="100%" cellpadding="0">
            <tr>
              <td width="3%">&nbsp;</td>
              <td width="50%"><font color="#0000FF"><br>
              for</font> x = -1
              <font color="#0000FF">to</font> c <br>
          &nbsp;&nbsp;<font color="#0000FF">if</font> trs.EOF =
              <font color="#0000FF">true</font> <font color="#0000FF">or</font> x &gt; 100
              <font color="#0000FF">then</font><br>
          &nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000FF">exit for</font><br>
          &nbsp;&nbsp;<font color="#0000FF">end if</font><br>
          c = c + 1<br>
          (neka business akcija)<br>
              <font color="#0000FF">next</font></td>
            </tr>
          </table><p>Kada je malo bolje pogledao kod oko tog mjesta, shvatio je da je
          Stinky prolazio kroz recordset (koji je on po svojoj konvenciji
          imenovao trs) i radio istu akciju za svaki record u tom recordsetu.
          Kada ga je pitao zašto umjesto ove lobotomične konstrukcije nije
          napisao, onako štreberski i predvidljivo npr.<table border="0" cellspacing="0" width="100%" cellpadding="0">
            <tr>
              <td width="3%">&nbsp;</td>
              <td width="50%"><font color="#0000FF"><br>
              do until </font>trs.EOF <br>
          &nbsp;&nbsp;(neka business akcija)<br>
              &nbsp;&nbsp;trs.moveNext<br>
              <font color="#0000FF">loop<br>
&nbsp;</font></td>
            </tr>
          </table>, Stinky je samo odgovorio: &quot;Pa for petljica mi se u tom
          trenutku učinila zgodnijom. Htio sam malo eksperimentirati&quot;. Tada je
          Bojan shvatio koliko je Stinkyu stalo do timskog rada, konvencija
          kodiranja i obzira prema drugim developerima.<p class="ContentSubTitle">
          <a name="Maddogov Update podataka u bazi">Maddogov Update podataka u bazi</a></p>
          <p>Jednog dana u šampionima Maddog je bjesnio više nego inače i psovao
          nešto što mu ne radi. Već su se ostali navikli da ga ignoriraju i
          pojačaju zvuk na slušalicama, ali bio je stvarno naporan pa se Bartol
          odlučio da ipak vidi što muči velikog šampiona. Maddog je objasnio da
          mu stalno puca snimanje u bazu a kod je tako jednostavan i mora
          raditi. Bartol ga je zamolio da mu pokaže kako sprema u bazu tj. gdje
          je ta stored procedura. Na spomen stored procedura obrijana veličina
          ga je samo pogledao i rekao: &quot;Ma ne, ne koristim procedure, već to
          radim iz koda u VB-u. Evo vidi:&quot;
          <table border="0" cellspacing="0" width="100%" cellpadding="0">
            <tr>
              <td width="3%">&nbsp;</td>
              <td width="50%"><font color="#0000FF"><br>
              </font><font size="2">RSTemp.MoveFirst<br>
              <font color="#0000FF">WHILE NOT</font> RsTemp.EOF
              <font color="#0000FF">DO</font><br>
              &nbsp;&nbsp;RStemp.nesto = nesto<br>
              &nbsp;&nbsp;RSTemp.UPDATE<br>
              &nbsp;&nbsp;RSTemp.MoveNext<br>
              <font color="#0000FF">WEND</font></font></td>
            </tr>
          </table><br>
          Nakon prvog prolaska kroz petlju, update operacija je pucala. &quot;A da li
          si siguran da i nakon update možeš sigurno ići dalje kroz recordset,
          možda ostane u nekom nedefiniranom stanju?&quot;, pitao je Bartol. &quot;Ne, ne,
          tako sigurno može, ovaj kod sam iskopirao iz DAMP-a&quot;, nije sumnjao u
          svoje rješenje Maddog. &quot;To ti je vrlo tricky operacija, ići kroz
          recordset i usput ga stalno mijenjati. Ali dobro, ako ti kažeš. Nego,
          daj da vidim tablicu koju hoćeš ažurirati&quot;, nastavio je Bartol. Nato
          je Maddog u SQL Enterprise manageru otvorio definiciju tablice i
          Bartol je kao iz topa izvalio jedno nevino pitanje: &quot;A gdje ti je
          PRIMARY key u tablici?&quot; &quot;Kakav primary key, zar to treba?&quot;, čudio se
          Maddog, &quot;pa MS Project tablice isto nemaju primary key!&quot; &quot;Pa, ne znam,
          ja sam možda glup ali su mene učili da bi svaka tablica trebala imati
          primarni ključ. Mislim da to muči i tvoj svemoćni ADO koji pokušava
          nakon update doći do novog recorda a nema se za što uhvatiti&quot;, jedva
          susprežući smijeh je procijedio Bartol, &quot;ajde, probaj kreirati
          primarni ključ u toj tablici.&quot; Uskoro je Maddog veselo uskliknuo: &quot;Pa
          to radi, jebi ga, ko bi rekao da treba napraviti taj primary key. Pa
          ni oni ga nisu imali!&quot; i sasuvši još par psovki na račun projektanata
          MS projecta Maddog je nastavio otkrivati čarobni svijet programiranja.<p class="ContentSubTitle">
          <a name="Šampion nikad ne kaže NOT! (by Stinky)">Šampion nikad ne kaže NOT! (by Stinky)</a></p>
          <p>Učeći programiranje šampionskom metodom pikanja, isprobavanja i
          kopiranja tuđeg koda, Stinky je propustio naučiti jedan logički
          operator. Možda zato što riječ NE nije u šampionskom vokabularu? Evo
          kako je Stinkyev kod rješavao problem negiranja logičke vrijednosti, u
          ovom slučaju Visible propertya njemu omiljene ActiveBar kontrole.</p>
          <p>
          MDImain.ab.Bands(&quot;frmButtonBar&quot;).Visible = <font color="#0000FF">IIf</font>(MDImain.ab.Bands(&quot;frmButtonBar&quot;).Visible,
          <font color="#0000FF">False</font>, <font color="#0000FF">True</font>)</p>
          <p class="ContentSubTitle">
          <a name="Točka, točka, točkica (by svi šampioni)">Točka, točka, točkica (by svi šampioni)</a></p>
          <p>U gornjem primjeru jedne programske linije vidi se još jedan detalj
          na koji šampioni nisu obraćali pažnju, a to je keširanje objektnih
          propertya u lokalnim varijablama. Svatko tko je ikad čitao neke
          priručnike ili knjige o programiranju zna da je višestruko uzastopno
          pozivanje istih propertya i metoda objekata rasipanje vremena. Često
          se iza propertya ne krije trivijalan podatak već se možda radi neki
          time-consuming proces. Razumno je tada vrijednost propertya dohvatiti
          samo jednom, pohraniti ih u lokalnim varijablama, a onda se kasnije
          referencirati na te varijable. Takva navika može u nekim scenarijima
          znatno povećati performanse programa, a programski kod ne postaje
          znatno kompleksniji, dapače čak može biti jednostavniji i logičniji za
          onog tko ga naknadno čita.</p>
          <p>Keširanje se ne mora raditi samo kod pristupa objektima, već i kod
          poziva obične funkcije koja radi neku transformaciju. Koliko je
          šampionska ignorancija takvog pristupa bila velika, najbolje pokazuje
          sljedeći nakaradni primjer:
           <table border="0" cellspacing="0" width="100%" cellpadding="0">
            <tr>
              <td width="3%">&nbsp;</td>
              <td width="50%"><font color="#0000FF"><br>
              If</font> UBound(Split(strRecepientList, &quot;;&quot;)) &gt; -1
              <font color="#0000FF">Then</font><br>
              <font color="#0000FF">For</font> cnt = 0 <font color="#0000FF">To</font>
              UBound(Split(strRecepientList, &quot;;&quot;))<br>
          &nbsp;&nbsp;<font color="#0000FF">If</font> Len(Split(strRecepientList,
              &quot;;&quot;)(cnt)) &gt; 0 <font color="#0000FF">Then</font>
              oMail.Recipients.Add
          &nbsp;&nbsp;&nbsp;&nbsp;Split(strRecepientList, &quot;;&quot;)(cnt)<br>
          &nbsp;&nbsp;<font color="#0000FF">Next</font> cnt<br>
              <font color="#0000FF">End If</font></td>
            </tr>
          </table>
          </p>
          <p>Umjesto da lijepo jednom napravi Split stringa u array i to pohrani
          u varijablu na koju će se kasnije stalno referencirati, šampionski
          autor je uporno, copy-paste metodom, &quot;cepao&quot; string svaki put kad mu
          je zatrebao neki element polja. Možda je mislio da kad jednom spremi
          rezultat u varijablu to više neće biti isto.</p>
          <p class="ContentSubTitle">
          <a name="Usporedba logičke varijable s True ili False (Stinky)">
          Usporedba logičke varijable s True ili False (Stinky)</a></p>
          <p>Ovo je bio Stinkyev specijalitet za koji nismo sigurni da ćete svi
          shvatiti kao grešku. Čuli smo od još nekih samozvanih VB gurua da je
          to normalna stvar. Hebi ga, mi valjda nismo normalni ali to nam je
          smetalo jer je očito otkrivalo da Stinky ne kuži da u logičkim
          izrazima ne mora uvijek stajati relacijski operator (=, &lt; ili &gt;). O
          čemu se radi? Dakle, Stinky je običavao pisati npr.:</p>
          <p><font color="#0000FF">If</font> FormLoaded(&quot;frmODBCOpen&quot;) =
          <font color="#0000FF">True</font> <font color="#0000FF">Then</font>
          Unload frmODBCOpen</p>
          </p>
          Ako funkcija FormLoaded vraća boolean vrijednost, onda je suvišno
          uspoređivati to s konstantom True, već se taj dio može izostaviti.
          Dakle:<p><font color="#0000FF">If</font> FormLoaded(&quot;frmODBCOpen&quot;)
          <font color="#0000FF">Then</font> Unload frmODBCOpen</p>
          <p>I tako pišu svi koji se ne smatraju šampionima, bar iz našeg
          iskustva. Griješimo li?</p>

          <p class="ContentSubTitle">
          <a name="Zanimljivo izračunavanje broja elemenata polja (Nepoznati autor)">
          Zanimljivo izračunavanje broja elemenata polja (by Nepoznati autor)</a></p>

          <p>Ovu cvebu ne možemo nažalost pripisati niti jednom od poznatih
          šampiona ali vrijedi je zabilježiti. Dakle, autor je očito htio
          izračunati koliko dobiveni array ima elemenata. S obzirom da su svi
          šampioni tvrdili da su više nego iskusni u VB-u i VBScriptu, ostaje
          pitanje zašto umjesto petlje nije jednostavno iskoristio UBound
          funkciju. Možda se bojao upotrijebiti je? Ili, ne daj bože, nije znao
          za nju?</p>
          <table border="0" cellspacing="0" width="100%" cellpadding="0">
            <tr>
              <td width="3%">&nbsp;</td>
              <td width="50%"><font color="#0000FF"><br>
              </font>aOrder = Split(strOrder, &quot;,&quot;, -1, 1)<br>
          alen = 0<br>
              <font color="#0000FF">For</font> <font color="#0000FF">Each</font> a
              <font color="#0000FF">In</font> aOrder<br>
          &nbsp;&nbsp;alen = alen + 1<br>
              <font color="#0000FF">Next<br>
&nbsp;</font></td>
            </tr>
          </table>
          <p class="ContentSubTitle">
          <a name="Šampionski efikasno brisanje svih zapisa u tablici (by Pridruženi šampion)">Šampionski efikasno brisanje svih zapisa u tablici (by Pridruženi
          šampion)</a></p>

          <p>Sljedeći &quot;coding pearl&quot; je jednom od autora sitea ostao u sjećanju
          iz vremena prije nego je došao u šampione ali se po ideji definitivno
          zaslužuje uvrstiti među šampionske bisere. Autor bisera je inače jedan
          stopostotni šampion iz vremena dok se još bavio programiranjem što je
          na sreću prestao činiti. Da je upoznao Maddoga, vjerojatno bi se
          lijepo slagali jer ovaj odsječak jako podsjeća na Maddogov stil
          kodiranja i shvaćanja baza. Eh da, ne smijemo zaboraviti reći da
          dotični autor nije imao pojma o SQL-u i da je tvrdio &quot;Što će mi to,
          kad u Accessu lijepo vizualno možeš složiti bilo kakav query?&quot;
          Kod je inače izvađen iz Access modula.</p>
          <table border="0" cellspacing="0" width="100%" cellpadding="0">
            <tr>
              <td width="3%">&nbsp;</td>
              <td width="50%"><font color="#0000FF"><br>
              </font>rstNesto = db.OpenRecordset(&quot;Neka_Tablica_u_Access_bazi&quot;)<font color="#0000FF"><br>
              </font>rstNesto.moveFirst<br>
              <font color="#0000FF">Do until</font> rstNesto.EOF<br>
          &nbsp;&nbsp;rstNesto.Delete<br>
          &nbsp;&nbsp;rstNesto.MoveNext<br>
              <font color="#0000FF">Loop</font><br>
&nbsp;</td>
            </tr>
          </table>

          <p>Dakle, jasno vam je da je šampion htio obrisati sve zapise u nekoj
          tablici. Da ga parafraziramo &quot;Što će mi SQL i Delete query kad mogu
          lijepo ići u petlji i brisati zapise?&quot; Inače, priča se da je dotični
          svojevremeno razmišljao da otvori školu za programere. :((</p>

         <br>
          </td>
        </tr>
        <tr>
          <td class="separator" width="3%">&nbsp;</td>
          <td class="Content">
            <a href="/biseri/kod/primjeri_koda2.html" target="" style="{text-decoration: none;}">Nastavak&nbsp;(Next)</a>
          </td>
        </tr>
        <tr>
          <td colspan="2" height="10">&nbsp;</td>
        </tr>
        <tr>
          <td class="footertopborder" colspan="2" height="1"><img height="1" src="/images/1.gif" width="1"></td>
        </tr>
        <tr>
          <td colspan="2" class="footer">


Šampioni.com ne odgovara za duševne boli pogođenih šampiona.<br>
Za sva pitanja u vezi sitea šaljite mail na: <a href="mailto:administrator@sampioni.com">
administrator@sampioni.com</a></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
	</body>
</html>
